<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="color-scheme" content="light only"/>
  <meta name="supported-color-schemes" content="light"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¥Ù„ÙŠÙƒÙ ÙŠØ§ Ø­Ø¨ÙŠØ¨ØªÙŠ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400;1,700&family=Scheherazade+New:wght@400;700&family=Petit+Formal+Script&display=swap');

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --parchment: #f5ead6;
      --parchment-dark: #e8d5b0;
      --ink: #2c1a0e;
      --ink-light: #5a3820;
      --wax: #c0392b;
      --wax-dark: #922b21;
      --gold: #c9933a;
      --gold-light: #e8b96a;
      --shadow: rgba(44, 26, 14, 0.18);
    }

    html {
      background: #120602 !important;
      color-scheme: light only;
    }

    html, body {
      height: 100%;
      background: #1a0a04 !important;
      font-family: 'Scheherazade New', 'Amiri', Georgia, serif;
      color: var(--ink);
      overflow-x: hidden;
    }

    /* â”€â”€ Candle / ambient background â”€â”€ */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 60% 55% at 50% 20%, rgba(200,120,30,0.18) 0%, transparent 70%),
        radial-gradient(ellipse 80% 70% at 50% 100%, rgba(100,30,5,0.4) 0%, transparent 60%),
        #120602;
      z-index: 0;
    }

    /* â”€â”€ Floating particles â”€â”€ */
    .particles { position: fixed; inset: 0; pointer-events: none; z-index: 1; overflow: hidden; }
    .particle {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,200,80,0.9), transparent 70%);
      animation: float linear infinite;
      opacity: 0;
    }

    @keyframes float {
      0%   { transform: translateY(100vh) translateX(0) scale(0.5); opacity: 0; }
      10%  { opacity: 1; }
      90%  { opacity: 0.6; }
      100% { transform: translateY(-10vh) translateX(var(--drift)) scale(1); opacity: 0; }
    }

    /* â”€â”€ Page wrapper â”€â”€ */
    .page {
      position: relative;
      z-index: 2;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    /* â”€â”€ Envelope wrapper â”€â”€ */
    .scene { perspective: 1200px; }

    /* â”€â”€ The letter itself â”€â”€ */
    .letter-wrap {
      position: relative;
      width: min(680px, 95vw);
    }

    /* Wax seal button */
    .seal-stage {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
      animation: fadeIn 1.2s ease both;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .seal-hint {
      font-family: 'Scheherazade New', 'Amiri', serif;
      font-size: clamp(1.1rem, 3.5vw, 1.5rem);
      color: rgba(255, 220, 140, 0.75);
      letter-spacing: 0.02em;
      text-align: center;
      line-height: 1.8;
    }

    .seal-btn {
      position: relative;
      width: 130px;
      height: 130px;
      border-radius: 50%;
      background: radial-gradient(circle at 38% 38%, var(--wax), var(--wax-dark) 60%, #5a1010);
      border: none;
      cursor: pointer;
      box-shadow:
        0 0 0 4px rgba(192,57,43,0.3),
        0 0 30px rgba(192,57,43,0.5),
        0 8px 32px rgba(0,0,0,0.6);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 4px;
    }
    .seal-btn:hover {
      transform: scale(1.06) rotate(3deg);
      box-shadow:
        0 0 0 4px rgba(192,57,43,0.5),
        0 0 50px rgba(220,80,50,0.7),
        0 12px 40px rgba(0,0,0,0.7);
    }
    .seal-btn:active { transform: scale(0.97) rotate(1deg); }

    .seal-monogram {
      font-family: 'Petit Formal Script', cursive;
      font-size: 2.8rem;
      color: rgba(255,230,180,0.92);
      text-shadow: 0 1px 4px rgba(0,0,0,0.5);
      line-height: 1;
      pointer-events: none;
    }
    .seal-hearts {
      font-size: 0.7rem;
      color: rgba(255,200,150,0.6);
      letter-spacing: 4px;
      pointer-events: none;
    }

    /* â”€â”€ Letter â”€â”€ */
    .letter {
      display: none;
      opacity: 0;
      transform: rotateX(-8deg) scale(0.92);
      transition: opacity 0.8s ease, transform 0.8s ease;
    }
    .letter.visible {
      opacity: 1;
      transform: rotateX(0deg) scale(1);
    }
    .letter.shown { display: block; }

    .paper {
      background:
        repeating-linear-gradient(
          transparent,
          transparent 31px,
          rgba(44,26,14,0.07) 31px,
          rgba(44,26,14,0.07) 32px
        ),
        linear-gradient(160deg, #fdf3df 0%, var(--parchment) 40%, #f0ddb8 100%) !important;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      border-radius: 3px;
      padding: clamp(36px, 8vw, 64px) clamp(32px, 8vw, 72px) clamp(48px, 10vw, 80px);
      box-shadow:
        0 2px 0 var(--parchment-dark),
        0 4px 0 rgba(44,26,14,0.1),
        0 20px 60px rgba(0,0,0,0.5),
        0 40px 100px rgba(0,0,0,0.3),
        inset 0 0 80px rgba(200,160,80,0.08);
      position: relative;
      overflow: hidden;
    }

    /* Paper texture grain */
    .paper::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
      opacity: 0.5;
      pointer-events: none;
      border-radius: 3px;
    }

    /* Left margin line */
    .paper::after {
      content: '';
      position: absolute;
      top: 0; left: 88px; bottom: 0;
      width: 1px;
      background: rgba(192,57,43,0.15);
    }

    .letter-header {
      text-align: center;
      margin-bottom: 40px;
      animation: revealLine 0.7s ease 0.2s both;
    }

    @keyframes revealLine {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .letter-date {
      font-family: 'IM Fell English', serif;
      font-style: italic;
      font-size: 0.9rem;
      color: var(--ink-light);
      letter-spacing: 0.1em;
      margin-bottom: 8px;
    }

    .letter-title {
      font-family: 'Scheherazade New', 'Amiri', serif;
      font-size: clamp(2.8rem, 9vw, 5rem);
      color: var(--wax-dark);
      line-height: 1.4;
      font-weight: 700;
      text-shadow: 2px 2px 8px rgba(200,100,50,0.2), 0 0 40px rgba(192,57,43,0.1);
      letter-spacing: 0.04em;
    }

    .divider {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 24px 0;
      animation: revealLine 0.7s ease 0.4s both;
    }
    .divider-line { flex: 1; height: 1px; background: linear-gradient(90deg, transparent, var(--gold), transparent); }
    .divider-heart { color: var(--wax); font-size: 0.9rem; }

    /* Message cards */
    .messages { display: flex; flex-direction: column; gap: 0; }

    .message-card {
      padding: 18px 0;
      border-bottom: 1px solid rgba(44,26,14,0.08);
      animation: revealLine 0.6s ease both;
      cursor: default;
      position: relative;
    }
    .message-card:last-child { border-bottom: none; }
    .message-card:hover .message-text { color: var(--ink); }

    .message-number {
      font-family: 'Petit Formal Script', cursive;
      font-size: 1.4rem;
      color: var(--wax);
      opacity: 0.5;
      position: absolute;
      left: -44px;
      top: 18px;
    }

    .message-text {
      font-family: 'Scheherazade New', 'Amiri', serif;
      font-size: clamp(1.1rem, 3vw, 1.35rem);
      line-height: 2.2;
      color: var(--ink-light);
      font-style: normal;
      transition: color 0.3s ease;
      text-align: right;
    }
    .message-text em {
      font-style: normal;
      color: var(--wax-dark);
      font-family: 'Petit Formal Script', cursive;
      font-size: 1.2em;
    }

    /* Signature */
    .letter-footer {
      margin-top: 40px;
      text-align: left;
      animation: revealLine 0.7s ease 0.6s both;
    }
    .footer-yours {
      font-family: 'Amiri', serif;
      font-style: italic;
      font-size: 1rem;
      color: var(--ink-light);
      margin-bottom: 6px;
    }
    .footer-name {
      font-family: 'Scheherazade New', 'Amiri', serif;
      font-size: clamp(1.8rem, 5vw, 2.8rem);
      color: var(--ink);
      line-height: 1.4;
    }
    .footer-hearts {
      font-size: 1rem;
      color: var(--wax);
      margin-top: 6px;
      letter-spacing: 6px;
    }

    /* â”€â”€ Navigation â”€â”€ */
    .nav {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-top: 28px;
      animation: fadeIn 0.8s ease 1s both;
    }

    .nav-btn {
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(200,150,80,0.3);
      color: rgba(255,220,140,0.7);
      font-family: 'IM Fell English', serif;
      font-style: italic;
      font-size: 0.9rem;
      padding: 10px 22px;
      border-radius: 2px;
      cursor: pointer;
      transition: all 0.25s ease;
      letter-spacing: 0.05em;
    }
    .nav-btn:hover {
      background: rgba(192,57,43,0.2);
      border-color: rgba(192,57,43,0.5);
      color: rgba(255,220,140,0.95);
    }
    .nav-btn:disabled {
      opacity: 0.25;
      cursor: default;
      pointer-events: none;
    }

    .page-indicator {
      font-family: 'IM Fell English', serif;
      font-style: italic;
      font-size: 0.85rem;
      color: rgba(255,200,120,0.45);
      min-width: 80px;
      text-align: center;
    }


    /* Responsive margin nums */
    @media (max-width: 500px) {
      .message-number { display: none; }
      .paper::after { display: none; }
      .paper { padding: 28px 24px 48px; }
    }
  </style>
</head>
<body>

<!-- Floating embers -->
<div class="particles" id="particles"></div>

<div class="page">
  <div class="scene">
    <div class="letter-wrap">

      <!-- Sealed state -->
      <div class="seal-stage" id="sealStage">
        <p class="seal-hint">Ø±Ø³Ø§Ù„Ø© Ù…Ø®ØªÙˆÙ…Ø© Ø¨Ø§Ù„Ø­Ø¨ØŒ ØªÙ†ØªØ¸Ø± Ø±ÙŠÙˆÙÙŠâ€¦</p>
        <button class="seal-btn" id="sealBtn" aria-label="Ø§ÙØªØ­ Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
          <span class="seal-monogram" id="monogramDisplay">R</span>
          <span class="seal-hearts">Â· Â· Â·</span>
        </button>
        <p class="seal-hint" style="font-size:0.85rem; opacity:0.5;">Ø§Ø¶ØºØ·ÙŠ Ù„ÙØªØ­ Ø§Ù„Ø±Ø³Ø§Ù„Ø©</p>
      </div>

      <!-- Letter -->
      <div class="letter" id="letter">
        <div class="paper">
          <div class="letter-header">
            <p class="letter-date" id="letterDate"></p>
            <h1 class="letter-title" id="letterTitle">My Dearest Love</h1>
          </div>

          <div class="divider">
            <div class="divider-line"></div>
            <span class="divider-heart">â§</span>
            <div class="divider-line"></div>
          </div>

          <div class="messages" id="messagesContainer"></div>

          <div class="divider" style="margin-top:32px;">
            <div class="divider-line"></div>
            <span class="divider-heart">â§</span>
            <div class="divider-line"></div>
          </div>

          <div class="letter-footer">
            <p class="footer-yours">Ù„ÙƒÙ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¯ØŒ</p>
            <p class="footer-name" id="sigName">Your Love</p>
            <p class="footer-hearts">ğŸ«‚ğŸ’‹ğŸ«‚</p>
          </div>
        </div>

        <div class="nav" id="navBar" style="display:none">
          <button class="nav-btn" id="prevBtn">Ø§Ù„Ø³Ø§Ø¨Ù‚ â†</button>
          <span class="page-indicator" id="pageIndicator"></span>
          <button class="nav-btn" id="nextBtn">â†’ Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>
      </div>

    </div>
  </div>
</div>



<script>
  // â”€â”€ Default content â”€â”€
  const specialFirstMessages = [
    'Ù‚Ù…Ø±ÙŠ â€¦',
    'Ø§Ù†Ø§ Ø§Ø­Ø±Øµ Ø¯Ø§ÙŠÙ… Ø§Ù†Ùƒ ØªÙƒÙˆÙ†ÙŠ Ù…Ù…ÙŠØ²Ø© Ù„Ø§Ù†Ùƒ Ø¨Ø§Ù„ÙØ¹Ù„ ØºÙŠØ±ØŒ Ø¹ÙŠØ¨ ÙÙŠ Ø­Ù‚ Ø­Ø¨ÙŠØ¨ØªÙŠ Ø§Ù†Ù‡Ø§ ØªØªØ³Ø§ÙˆÙ‰ Ù…Ø¹ ØºÙŠØ±Ù‡Ø§.',
    'Ø§Ø°Ø§ Ù‡Ù… Ø¹Ù†Ø¯Ù‡Ù… ÙŠÙˆÙ…ØŒ Ø§Ù†ØªÙŠ Ø¹Ù†Ø¯Ùƒ *Ù£Ù£Ù¥ ÙŠÙˆÙ…* Ù…Ù„ÙŠØ§Ù†Ù‡ Ù…Ø´Ø§Ø¹Ø± Ø®Ø§ØµØ© Ù„Ùƒ.',
    'Ø·Ø¨Ø¹Ø§ Ù„Ù„Ø§Ù† Ù‡Ø°Ø§ Ø§Ù„Ù„ÙŠ Ø§Ù‚Ø¯Ø± Ø§Ø³ÙˆÙŠÙ‡ Ù„ÙƒÙ† Ù…Ø³ØªÙ‚Ø¨Ù„Ù‹Ø§ Ø§Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø¨ØªØ´ÙˆÙÙŠÙ† Ø§Ø´ÙŠØ§Ø¡ Ø§Ø­Ù„Ù‰ Ø¨ÙƒØ«ÙŠØ±.'
  ];

  // Build 335 pages Ã— 1 message, minus special first pages
  const ahebukMessages = [];
  for (let i = 0; i < 335 - specialFirstMessages.length; i++) {
    ahebukMessages.push('Ø£Ø­Ø¨Ùƒ Ù„Ù„Ø£Ø¨Ø¯ â¤ï¸');
  }

  const DEFAULTS = {
    title: 'Ø±ÙŠÙˆÙÙŠ',
    signature: 'Ø¹Ø²ÙˆØ²Ùƒ',
    monogram: 'R',
    messages: [...specialFirstMessages, ...ahebukMessages]
  };

  // â”€â”€ State â”€â”€
  let data = JSON.parse(localStorage.getItem('valentines_data') || 'null') || {...DEFAULTS, messages: [...DEFAULTS.messages]};
  let currentPage = 0;
  const MSGS_PER_PAGE = 1;
  let opened = false;

  // â”€â”€ Particles â”€â”€
  const particlesEl = document.getElementById('particles');
  for (let i = 0; i < 28; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const size = 2 + Math.random() * 4;
    p.style.cssText = `
      width:${size}px; height:${size}px;
      left:${Math.random()*100}%;
      --drift:${(Math.random()-0.5)*120}px;
      animation-duration:${6+Math.random()*10}s;
      animation-delay:${Math.random()*12}s;
    `;
    particlesEl.appendChild(p);
  }

  // â”€â”€ Date â”€â”€
  document.getElementById('letterDate').textContent =
    new Date().toLocaleDateString('ar-EG', { year:'numeric', month:'long', day:'numeric' });

  // â”€â”€ Render letter â”€â”€
  function render() {
    document.getElementById('letterTitle').textContent = data.title || DEFAULTS.title;
    document.getElementById('sigName').textContent = data.signature || DEFAULTS.signature;
    document.getElementById('monogramDisplay').textContent = data.monogram || 'â™¥';

    const msgs = data.messages || [];
    const totalPages = Math.ceil(msgs.length / MSGS_PER_PAGE);
    if (currentPage >= totalPages) currentPage = Math.max(0, totalPages - 1);

    const container = document.getElementById('messagesContainer');
    container.innerHTML = '';

    const start = currentPage * MSGS_PER_PAGE;
    const slice = msgs.slice(start, start + MSGS_PER_PAGE);

    slice.forEach((msg, i) => {
      const div = document.createElement('div');
      div.className = 'message-card';
      div.style.animationDelay = `${0.3 + i * 0.15}s`;

      const isAhebuk = msg === 'Ø£Ø­Ø¨Ùƒ Ù„Ù„Ø£Ø¨Ø¯ â¤ï¸';

      const numSpan = document.createElement('span');
      numSpan.className = 'message-number';
      numSpan.textContent = start + i + 1;

      const p = document.createElement('p');
      p.className = 'message-text';
      if (isAhebuk) {
        p.style.cssText = `
          font-family: 'Amiri', serif;
          font-size: clamp(2.4rem, 9vw, 4.2rem);
          text-align: center;
          color: var(--wax-dark);
          line-height: 1.8;
          font-weight: 700;
          font-style: normal;
          letter-spacing: 0;
        `;
      }
      p.innerHTML = msg.replace(/\*(.*?)\*/g, '<em>$1</em>');

      div.appendChild(numSpan);
      div.appendChild(p);
      container.appendChild(div);
    });

    const navBar = document.getElementById('navBar');
    if (totalPages > 1) {
      navBar.style.display = 'flex';
      document.getElementById('prevBtn').disabled = currentPage === 0;
      document.getElementById('nextBtn').disabled = currentPage >= totalPages - 1;
      document.getElementById('pageIndicator').textContent = `ÙŠÙˆÙ… ${currentPage + 1} Ù…Ù† ${totalPages}`;
    } else {
      navBar.style.display = 'none';
    }
  }

  // â”€â”€ Seal / open â”€â”€
  document.getElementById('sealBtn').addEventListener('click', () => {
    if (opened) return;
    opened = true;
    const sealStage = document.getElementById('sealStage');
    const letter = document.getElementById('letter');

    sealStage.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
    sealStage.style.opacity = '0';
    sealStage.style.transform = 'scale(0.9)';

    setTimeout(() => {
      sealStage.style.display = 'none';
      letter.classList.add('shown');
      render();
      requestAnimationFrame(() => {
        requestAnimationFrame(() => { letter.classList.add('visible'); });
      });
    }, 500);
  });

  document.getElementById('prevBtn').addEventListener('click', () => {
    currentPage--;
    render();
  });
  document.getElementById('nextBtn').addEventListener('click', () => {
    currentPage++;
    render();
  });

</script>
</body>
</html>
